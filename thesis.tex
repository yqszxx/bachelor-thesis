% !TEX program = xelatex
\documentclass[degree=undergraduate,bibstyle=numerical,font=empty]{xmuthesis}

\usepackage{geometry}
\geometry{a4paper,scale=0.8}

\DeclareMathOperator*{\argmin}{argmin}

\usepackage{paralist}

\usepackage{rotating}

\makeatletter
\newenvironment{breakablealgorithm}
  {% \begin{breakablealgorithm}
   \begin{center}
     \refstepcounter{algorithm}% New algorithm
     \hrule height.8pt depth0pt \kern2pt% \@fs@pre for \@fs@ruled
     \renewcommand{\caption}[2][\relax]{% Make a new \caption
       {\raggedright\textbf{\fname@algorithm~\thealgorithm} ##2\par}%
       \ifx\relax##1\relax % #1 is \relax
         \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##2}%
       \else % #1 is not \relax
         \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##1}%
       \fi
       \kern2pt\hrule\kern2pt
     }
  }{% \end{breakablealgorithm}
     \kern2pt\hrule\relax% \@fs@post for \@fs@ruled
   \end{center}
  }
\makeatother

\usepackage{array}
\newcolumntype{x}[1]{>{\centering\arraybackslash\hspace{0pt}}p{#1}}

\xmusetup{
    author                  = 韩博阳 ,
    title                   = 基于 RISC-V 指令集的通用处理器安全性研究 ,
    date                    = \today , % 二〇一九年二月二十八日
    class                   = 2018级 ,
    studentnumber           = 35320182200138 ,
    department              = 电子科学与技术学院 ,
    major                   = 集成电路设计与集成系统 ,
    advisor                 = 周剑扬 \quad 教授 ,
    otheradvisor            = 无 ,
    team                    =  ,
    fundteam                =  ,
    degree                  = 本\quad 科 ,
    englishtitle            = Research on General-Purpose Processor Security Based on RISC-V Instruction Set ,
    majorordouble           = 主修 , % 辅修
    lab                     =  ,
    % 以下几项本科生无需填写，也不用删除
    classified_code         =  1234                       , % 分类号
    security_classification =  公开                       , % 内部 秘密 机密 公开 等
    UDC                     =  5                          , % 国际十进分类法
    submit_date             =  2020 年 8 月 10 日         , % 论文提交日期
    defense_date            =  2020 年 8 月 11 日         , % 论文答辩日期
    conferred_date          =  2020 年 8 月 21 日         , % 学位授予日期
    chairman                =  张三                       , % 答辩委员会主席
    referee                 =  李四                       , % 评阅人
}
\usepackage{xmulogo}
\listfiles
\begin{document}
\maketitle
\input{body/thanks}
\input{body/abstract}
\xmutableofcontents % 双语目录
\input{body/c1intro}
\input{body/c2spectre}
\input{body/c3dma}
\input{body/c4conclusion}
\nocite{*} 
\bibliography{ref}
\appendix
\chapter{Spectre漏洞利用代码}{Spectre Proof-of-Concept Code} \label{app:spectre-code}
\lstinputlisting[language=c]{body/spectre.c}

\chapter{虚拟到物理内存地址翻译程序}{Virtual to Physical Address Translator} \label{app:v2p}
\lstinputlisting[language=c]{body/v2p.c}

\chapter{PCIe设计框图}{Block Design of PCIe Endpoint} \label{app:pcie-ep}
\begin{sidewaysfigure}
	\centering
	\includegraphics[width=\textwidth]{figs/pcie-ep.pdf}
	\caption{软件可控PCIe Endpoint Block Design}
\end{sidewaysfigure}
% \backmatter
% 后记
\end{document}
